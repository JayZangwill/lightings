"use strict";if(function(){function t(e){return new t.prototype.init(e)}function e(t,e){return new Promise(function(s,i){if(e.xhr.responseType=e.dataType,"get"===t){var r=e.url;e.data&&(r+="?"+e.data),e.xhr.open(e.type,r,e.async),e.xhr.send(null)}else"post"===t&&(e.xhr.open(e.type,e.url,e.async),e.xhr.setRequestHeader("Content-type",e.contentType),e.xhr.send(e.data));e.xhr.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<300||304===this.status?s("xml"===this.flag?this.responseXML:this.response):i(this.status,this.statusText))},e.xhr.timeout=e.timeout,e.xhr.ontimeout=e.error,e.xhr.onloadstart=function(t){e.start&&e.start.call(this,t)},e.xhr.onprogress=function(t){e.progress&&e.progress.call(this,t)}})}t.prototype={constructor:t,init:function(t){var e=this;if(this.url=t.url,this.success=t.success,this.error=t.error,this.start=t.start,this.progress=t.progress,this.timeout=t.timeout||0,this.type=t.type||"get",this.flag=this.dataType=t.dataType.toLowerCase()||"json",this.contentType=t.contentType||"application/x-www-form-urlencoded",this.data=t.data||null,this.callbackName=t.callbackName||"callback",this.async=t.async||!0,this.xhr=new XMLHttpRequest,!this.url)throw Error("url is undefined");if("xml"!==this.dataType&&"html"!==this.dataType||(this.dataType=""),"boolean"!=typeof this.async&&(this.async=!0),this.data&&"[object Object]"===this.data.toString()){var s=[];for(var i in this.data)s.push(i+"="+this.data[i]);this.data=s.join("&")}else"string"!=typeof this.data&&(this.data=void 0);if("jsonp"===this.dataType){var r=document.createElement("script"),o=""+Math.random()+Math.random();return o=o.replace(/0\./g,"_"),r.src=this.data?this.url+"?"+this.callbackName+"=Lightings"+o+"&"+this.data:this.url+"?"+this.callbackName+"=Lightings"+o,document.body.appendChild(r),this.success&&"function"==typeof this.success&&(window["Lightings"+o]=this.success),document.body.removeChild(r),this}return"get"===this.type&&this.get().then(function(t){e.success&&e.success.call(e,t)}).catch(function(t){e.error&&e.error.call(e,t)}),"post"===this.type&&this.post().then(function(t){e.success&&e.success.call(e,t)}).catch(function(t){e.error&&e.error.call(e,t)}),this},get:function(){return e("get",this)},post:function(){return e("post",this)}},t.prototype.init.prototype=t.prototype,window.Lightings=t}(),!window.Promise){var _Promise=function t(e){var s=this;if(this.status="pending",this.thenCache=[],!(this instanceof t))throw'Defer is a constructor and should be called width "new" keyword';if("function"!=typeof e)throw"Defer params must be a function";setTimeout(function(){try{e.call(this,s.resolve.bind(s),s.reject.bind(s))}catch(t){s.reject(t)}},0)};_Promise.prototype.resolve=function(t){this.value=t,this.status="resolved",this.triggerThen()},_Promise.prototype.reject=function(t){this.value=t,this.status="rejected",this.triggerThen()},_Promise.prototype.then=function(t,e){return this.thenCache.push({onResolve:t,onReject:e}),this},_Promise.prototype.catch=function(t){"function"==typeof t&&(this.errorHandle=t)},_Promise.prototype.triggerThen=function(){var t,e=this.thenCache.shift();if(!e&&"resolved"===this.status)return this;if(!e&&"rejected"===this.status)return this.errorHandle&&(this.value=this.errorHandle.call(void 0,this.value),this.status="resolved"),this;if("resolved"===this.status?t=e.onResolve:"rejected"===this.status&&(t=e.onReject),"function"==typeof t)try{this.value=t.call(void 0,this.value),this.status="resolved",this.triggerThen()}catch(t){return this.status="rejected",this.value=t,this.triggerThen()}else this.triggerThen()},window.Promise=_Promise}